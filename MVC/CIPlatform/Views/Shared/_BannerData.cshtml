

<style>
  /*      #banner-preview img {
  max-width: 100%;
  max-height: 100%;
  object-fit: cover;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
  border-radius: 5px;
   object-fit: cover; 
     box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5); 
      transition: transform 0.3s ease-in-out;
    }

        #banner-preview img:hover {
            transform: scale(1.1);
        }*/

    .applyButton {
        border: 2px solid #F88634;
        border-radius: 100px;
        color: #F88634;
        background-color: white;
        }

        .applyButton:hover {
            background-color: #F88634;
            color: white;
        }

        .skill:hover {
        background-color: #F88634;
        color: white;
        cursor: pointer;
    }
         #banner-preview .preview-container {
        display: inline-block;
        position: relative;
        margin: 5px;
        width: 100px;
        height: 100px;
        overflow: hidden;
        }
        #banner-preview .preview-container img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
        }
        #banner-preview .preview-container .remove-icon {
            position: absolute;
            top: 5px;
            margin-left: 40px;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
        }  
        #banner-previewedit .preview-containeredit {
        display: inline-block;
        position: relative;
        margin: 5px;
        width: 100px;
        height: 100px;
        overflow: hidden;
        }
        #banner-previewedit .preview-containeredit img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
        }
        #banner-previewedit .preview-containeredit .remove-icon {
            position: absolute;
            top: 5px;
            margin-left: 40px;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
        }

        #imgPreview img {
    max-width: 100%;
    margin: 10px 0;
    border: 1px solid #ddd;
}

</style>

<div id="bannerpage">
    
    <div class="row gx-0">
        <table class="table table-hover table-bordered" style="width: 99%;margin-inline: auto; text-align: center;">
            <thead>
                <tr class="table-light" style="height: 70px;">
                    <th scope="col">Image</th>
                    <th scope="col">BannerText</th>
                    <th scope="col">Sortorder</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            @foreach (var item in @ViewBag.BannerList)
            {
                <tbody class="table-border">
                    <tr>
                        <td><img src="~/Assets/StoryImages/@item.Image" class="img rounded-5" style="height: 100px; width: 100px;"></td>
                        <td>@item.Text</td>
                        <td>@item.SortOrder</td>
                        <td>
                            <button type="button" class="btn p-0" onclick="editBanner('nav-banner',@item.BannerId)"><i class="bi bi-pencil-square" style="color: coral;"></i></button>
                            <button type="button" class="btn p-0" data-bs-toggle="modal" data-bs-target="#exampleModalDeleteBanner-@item.BannerId"><i class="bi bi-trash ms-3"></i></button>


                            <!-- Modal For Delete Banner -->
                        <div class="modal fade" id="exampleModalDeleteBanner-@item.BannerId" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">

                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="exampleModalLabel">
                                                Are you sure for delete this Banner
                                            </h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>

                                        <form method="post">

                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary bg-transparent border border-2 rounded-pill text-secondary" data-bs-dismiss="modal">Cancel</button>
                                                <button type="submit" onclick="deleteBanner(@item.BannerId,event)" class="btn applyButton" data-bs-dismiss="modal">Delete</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            }
        </table>

    </div>

    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center" onchange="searchMission()">
            <li class="page-item">
                <button class="page-link" type="submit" aria-label="Previous" onclick="searchMission(1,'banner')">
                    <span aria-hidden="true">&laquo;</span>
                </button>
            </li>
            @{
                double totalpages = ViewBag.ttlBanners;

                for (int i = 1; i <= totalpages; i++)
                {
                    @if (i == ViewBag.pg_no)
                    {
                        <li class="page-item active">
                            <button class="page-link" type="submit" onclick="searchMission(@i,'banner')">@i</button>

                        </li>
                    }
                    else
                    {
                        <li class="page-item">
                            <button class="page-link" type="submit" onclick="searchMission(@i,'banner')">@i</button>
                        </li>
                    }


                }

                <li class="page-item">
                    <button class="page-link" type="submit" aria-label="Next" onclick="searchMission(@totalpages,'banner')">
                        <span aria-hidden="true">&raquo;</span>
                    </button>
                </li>
            }
        </ul>
    </nav>
</div>


<div class="border" id="add" style="display: none;">
    <h3 class="p-3 m-0" style="background-color: #F8F9FC;"> Add </h3>
    <hr class="m-0">
    <form class="px-3" enctype="multipart/form-data">
        <label class="mt-3"> Banner Text </label>
        <input type="text" class="form-control" id="addBannerText">

        <label class="mt-3"> Short Order </label>
        <input type="number" class="form-control" id="addShortOrder">



        <div class="images w-100 mt-4 ">
            <label class="form-label">Upload Your Photos</label>
            <div class="w-100 border rounded d-flex flex-column align-items-center justify-content-center" style="height:100px;border-style:dashed;">
                <img src="~/Assets/images/add.png" style="cursor:pointer;position:relative; top:20px;" />
                <input type="file" accept="image/*" name="images" id="bannerImage" style="opacity:0;cursor:pointer;" required />
                <p style="margin-block:0px;cursor:pointer;"> Upload Pictures Here</p>
            </div>
            <div id="banner-preview"></div>
        </div>

        <div class="row my-3">
            <div class="col-xl-10 col-lg-8 col-md-8 col-sm-8 "></div>
            <div class="col-xl-2 col-lg-4 col-md-4 col-sm-4 ">
                <button type="button" class="cancell rounded-pill btn btn-outline-dark"
                        onclick="bannerView('nav-banner');">
                    Cancel
                </button>
                <button type="submit" onclick="addBannerData(event)" class="btn rounded-pill applyButton"
                        value="2" name="command">
                    Save
                </button>
            </div>
        </div>
    </form>
</div>

<div class="border" id="edit" style="display: none;">
    <h3 class="p-3 m-0" style="background-color: #F8F9FC;"> Edit </h3>
    <hr class="m-0">
    <form class="px-3" enctype="multipart/form-data">
        <input type="hidden" id="bannerId" />
        <label class="mt-3"> Banner Text </label>
        <input type="text" class="form-control" id="editBannerText">

        <label class="mt-3"> Short Order </label>
        <input type="number" class="form-control" id="editShortOrder">



        <div class="images w-100 mt-4 ">
            <label class="form-label">Upload Your Photos</label>
            <div class="w-100 border rounded d-flex flex-column align-items-center justify-content-center" style="height:100px;border-style:dashed;">
                <img src="~/Assets/images/add.png" style="cursor:pointer;position:relative; top:20px;" />
                <input type="file" accept="image/*" name="images" id="editbannerImage" style="opacity:0;cursor:pointer;" required />
                <p style="margin-block:0px;cursor:pointer;"> Upload Pictures Here</p>
            </div>
        </div>
        <div id="banner-previewedit"></div>
        <div id="imgPreview">
        </div>

        <div class="row my-3">
            <div class="col-xl-10 col-lg-8 col-md-8 col-sm-8 "></div>
            <div class="col-xl-2 col-lg-4 col-md-4 col-sm-4 ">
                <button type="button" class="cancell rounded-pill btn btn-outline-dark"
                        onclick="editBannerClose('nav-banner');">
                    Cancel
                </button>
                <button type="submit" onclick="addBannerData(event)" class="btn rounded-pill applyButton"
                        value="2" name="command">
                    Save
                </button>
            </div>
        </div>
    </form>
</div>

<script>
// listen for changes to the file input
$('#bannerImage').on('change', function() {
    // get the selected file
    var file = this.files[0];
    
    // create a URL for the selected file
    var url = URL.createObjectURL(file);
    
    // create an img element and set its src attribute
    var img = $('<img>').attr('src', url);
    
    // append the img element to the banner-preview div
    $('#banner-preview').empty().append(img);
});

$('#editbannerImage').on('change', function() {
    // get the selected file
    var file = this.files[0];
    
    // create a URL for the selected file
    var url = URL.createObjectURL(file);
    
    // create an img element and set its src attribute
    var img = $('<img>').attr('src', url);
    
    // append the img element to the banner-preview div
    $('#imgPreview').empty()
    $('#banner-previewedit').empty().append(img);
});

    function addBannerData(event) {
                       debugger
                       var bannerId = $('#bannerId').val();
                        if(bannerId != 0)
                        {
                            const imgs = document.getElementById("editbannerImage").files;

                             event.preventDefault();
                             var formData = new FormData();
                                formData.append('Text', $('#editBannerText').val());
                                formData.append('BannerId', $('#bannerId').val());
                                formData.append('SortOrder', $('#editShortOrder').val());
                                formData.append('BannerImg', imgs[0]);
                            

                        }
                        else
                        {
                         const imgs = document.getElementById("bannerImage").files;

                         event.preventDefault();
                         var formData = new FormData();
                            formData.append('Text', $('#addBannerText').val());
                            formData.append('SortOrder', $('#addShortOrder').val());
                            formData.append('BannerImg', imgs[0]);
                            

                        }
                             $.ajax({
                                 type: 'POST', 
                                 url: '/Admin/AddBanner',
                                 data: formData,
                                 contentType: false,
                                 processData: false,
                                 success: function(data) {
                                     debugger
                                     bannerView('nav-banner');
                                     console.log(data);
                                     $('#banners').html(data);
                                     if(bannerId != 0)
                                     {
                                         toastr.success('Banner Updated');
                                     }
                                     else
                                     {
                                        toastr.success('Banner add sucessfully');
                                     }
                            

                                 },
                                 error: function (error) {
                                 console.log(error);
                                 }
                             });
     }

     function getBannerData(bannerId)
        {
            console.log(bannerId);
            debugger
            $.ajax({
                         type: 'POST',
                         url: '/Admin/EditBanner',
                         data: {"BannerId": bannerId},
                         success: function(data) {
                             console.log(data);
                             debugger

                             $('#bannerId').val(data.bannerId);
                             $('#editBannerText').val(data.text);
                             $('#editShortOrder').val(data.sortOrder);
                             
                             $('#imgPreview').empty();
                             var img = $('<img>').attr('src', '../Assets/StoryImages/' + (data.image).toString());
                             $('#imgPreview').append(img);
                         },
                        error: function (request, error) {
                         console.log(error);
                     }
                     });
        }

     function deleteBanner(bannerId,event)
        {
            
             debugger
             event.preventDefault();
                $.ajax({
                         type: 'POST',
                         url: '/Admin/DeleteBanner',
                         data: {"BannerId": bannerId},
                         success: function(data) {
                             console.log(data);
                             debugger
                             bannerView('nav-banner');
                             console.log(data);
                             $('#banners').html(data);
                             toastr.error('Banner Deleted');
                         },
                        error: function (request, error) {
                         console.log(error);
                     }
                     });
        }
</script>


<script>
     function addBanner(x) {
            var page = document.getElementById(x);
            var bannerpage = page.querySelector("#bannerpage");
            var addBanner = page.querySelector("#add");
            var search = page.querySelector("#searchBanner1");
            search.style.display = "none";
            bannerpage.style.display = "none";
            addBanner.style.display = 'block';
        }
        function bannerView(x) {
            debugger
            $('#addBannerText').val('');
            $('#addShortOrder').val('');
            $('#banner-preview').empty();

            var page = document.getElementById(x);
            var bannerpage = page.querySelector("#bannerpage");
            var addBanner = page.querySelector("#add");
            var search = page.querySelector("#searchBanner1");
            search.style.display = "block";
            bannerpage.style.display = "block";
            addBanner.style.display = 'none';
        }
        function editBanner(x,id) {
           debugger
            var page = document.getElementById(x);
            var bannerpage = page.querySelector("#bannerpage");
            var addBanner = page.querySelector("#edit");
            var search = page.querySelector("#searchBanner1");
            search.style.display = "none";
            bannerpage.style.display = "none";
            addBanner.style.display = 'block';
            getBannerData(id);
        }
        function editBannerClose(x) {
            debugger
            var page = document.getElementById(x);
            var bannerpage = page.querySelector("#bannerpage");
            var addBanner = page.querySelector("#edit");
            var search = page.querySelector("#searchBanner1");
            search.style.display = "block";
            bannerpage.style.display = "block";
            addBanner.style.display = "none";
        }
</script>