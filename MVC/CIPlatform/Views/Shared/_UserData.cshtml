<style>
    
    #imagePreviewUser {
        position: absolute;
        margin-top: -150px;
    }

    #addUserAvatar {
        position: absolute;
        width: 1px;
        height: 150px;
        margin-top: -50px;
        padding-left: 170px;
        display: block;
        opacity: 0;
    }
</style>

<div id="userpage">
   


    <div class="row gx-0">
        <table class="table table-hover  table-bordered" style="width: 99%;margin-inline: auto;">
            <thead>
                <tr class="table-light" style="height: 70px;">
                    <th scope="col" class="thforcmstable">First Name</th>
                    <th scope="col" class="thforcmstable">Last Name</th>
                    <th scope="col" class="thforcmstable">Email</th>
                    <th scope="col" class="thforcmstable">Employee Id</th>
                    <th scope="col" class="thforcmstable">Department</th>
                    <th scope="col" class="thforcmstable">Status</th>
                    <th scope="col" class="thforcmstable">Action</th>
                </tr>
            </thead>
            @foreach (var item in @ViewBag.UserList)
            {
                <tbody class="table-border">
                    <tr>
                        <td>@item.FirstName</td>
                        <td>@item.LastName</td>
                        <td>@item.Email</td>
                        <td>@item.EmployeeId</td>
                        <td>@item.Department</td>
                        @if (item.Status == true)
                        {
                            <td style="color: green;">Active</td>
                        }
                        else
                        {
                            <td class="text-danger">Inactive</td>
                        }
                        <td>
                            <button type="button" class="btn p-0" onclick="editUser('nav-user',@item.UserId)"><i class="bi bi-pencil-square" style="color: coral;"></i></button>
                             <button type="button" class="btn p-0" data-bs-toggle="modal" data-bs-target="#exampleModalDeleteUser-@item.UserId"><i class="bi bi-trash ms-3"></i></button>


                                                 <!-- Modal For Delete User -->
                                                    <div class="modal fade" id="exampleModalDeleteUser-@item.UserId" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">

                                                        <div class="modal-dialog modal-dialog-centered">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">
                                                                        Are you sure for delete this User
                                                                    </h1>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>

                                                                <form method="post">

                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn btn-secondary bg-transparent border border-2 rounded-pill text-secondary" data-bs-dismiss="modal">Cancel</button>
                                                                        <button type="submit" onclick="deleteUser(@item.UserId,event)" class="btn applyButton" data-bs-dismiss="modal">Delete</button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                        </td>
                    </tr>
                </tbody>
            }
        </table>
    </div>



    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center" onchange="searchMission()">
            <li class="page-item">
                <button class="page-link" type="submit" aria-label="Previous" onclick="searchMission(1,'user')">
                    <span aria-hidden="true">&laquo;</span>
                </button>
            </li>
            @{
                double totalpages = ViewBag.ttlUsers;

                for (int i = 1; i <= totalpages; i++)
                {
                    @if (i == ViewBag.pg_no)
                    {
                        <li class="page-item active">
                            <button class="page-link" type="submit" onclick="searchMission(@i,'user')">@i</button>

                        </li>
                    }
                    else
                    {
                        <li class="page-item">
                            <button class="page-link" type="submit" onclick="searchMission(@i,'user')">@i</button>
                        </li>
                    }


                }

                <li class="page-item">
                    <button class="page-link" type="submit" aria-label="Next" onclick="searchMission(@totalpages,'user')">
                        <span aria-hidden="true">&raquo;</span>
                    </button>
                </li>
            }
        </ul>
    </nav>
</div>

<div class="border" id="add" style="display: none;">
    <h3 class="p-3 m-0" style="background-color: #F8F9FC;"> Add User</h3>
    <hr class="m-0">
    <form class="px-3" enctype="multipart/form-data">
        <div class="row">
            <div class="col-2">
                <a id="addUserPop">
                    <input id="addUserAvatar" type="file" class="file" accept="image/jpeg, image/png, image/jpg">

                    <img id="addUserDefaultAvatar" src="~/Assets/StoryImages/404-Page-image.png" class="rounded-circle" style="height:150px; max-width:150px;">
                </a>
            </div>

            <div class="col-10">
                <div class="row">
                    <div class="col-6">
                        <label class="mt-3"> First Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="addUserFirstName" oninput="" >
                        <span id="validAddUserFirstName" style="color:red;"></span>
                    </div>

                    <div class="col-6">
                        <label class="mt-3"> Last Name </label>
                        <input type="text" class="form-control" id="addUserLastName">
                    </div>
                </div>

                <div class="row">
                    <div class="col-6">
                        <label class="mt-3"> Email <span class="text-danger">*</span></label>
                        <input type="email" class="form-control" id="addUserEmail" onblur="addValidEmail(event,'add')">
                        <span id="validAddUserEmail" style="color:red;"></span>
                    </div>

                    <div class="col-6">
                        <label class="mt-3"> Password <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="addUserPassword" oninput="">
                        <span id="validAddUserPassword" style="color:red;"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-6">
                        <label class="mt-3"> Employee Id </label>
                        <input type="text" class="form-control" id="addUserEmployeeId">
                    </div>

                    <div class="col-6">
                        <label class="mt-3"> Department Name </label>
                        <input type="text" class="form-control" id="addUserDepartment">
                    </div>
                </div>



                <div class="row mt-2">
                    <div class="col-sm-3">
                        <label class="form-label">Country<span class="text-danger">*</span></label>

                        <select class="form-select" id="addUserCountry" onchange="GetCityUser()" onclick="()">
                            @*<option value="@data.CountryId" selected>@data.Country.CountryName</option>*@
                            @if (ViewBag.CountryList != null)
                            {
                                @foreach (var country in ViewBag.CountryList)
                                {
                                    <option value="@country.CountryId">@country.CountryName</option>
                                }
                            }
                        </select>
                        <span id="validAddUserCountry" style="color:red;"></span>
                    </div>

                    <div class="col-sm-3">
                        <label class="form-label">City<span class="text-danger">*</span></label>
                        <select class="form-select" id="selectUserCityList" onchange="()">

                            <option id="selectCityUser">Please select first country</option>

                        </select>
                        <span id="validAddUserCity" style="color:red;"></span>
                    </div>

                    <div class="col-sm-3">
                        <label class="form-label">User Status<span class="text-danger">*</span></label>
                        <select class="form-select" id="addUserStatus">
                            <option value="true">Active</option>
                            <option value="false">InActive</option>
                        </select>
                    </div>
                    
                    <div class="col-sm-3">
                        <label class="form-label">Role</label>
                        <select class="form-select" id="addUserRole">
                            <option value="User">User</option>
                            <option value="Admin">Admin</option>
                        </select>
                    </div>
                </div>

                <label class="mt-3"> Profile Text </label>
                <input type="text" class="form-control" id="addUserText">

                <div class="row my-3">
                    <div class="col-xl-10 col-lg-8 col-md-8 col-sm-8 "></div>
                    <div class="col-xl-2 col-lg-4 col-md-4 col-sm-4 ">
                        <button type="button" class="cancell rounded-pill btn btn-outline-dark" onclick="userView('nav-user');">Cancel</button>
                        <button type="submit" onclick="addValidUser(event)" class="btn rounded-pill applyButton addButton" value="2" name="command">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<div class="border" id="edit" style="display: none;">
    <h3 class="p-3 m-0" style="background-color: #F8F9FC;"> Edit User</h3>
    <hr class="m-0">
    <form class="px-3" enctype="multipart/form-data">
        <div class="row">
            <input type="hidden" id="userId" />


            <div class="col-2">
                <a id="editUserPop">
                    <input id="editUserAvatar" type="file" class="file" style="opacity: 0;height: 150px;max-width: 150px;margin-top: 50px;" accept="image/jpeg, image/png, image/jpg">
                </a>
            </div>

            <div class="col-10">
                <div class="row">
                    <div class="col-6">
                        <label class="mt-3"> First Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="editUserFirstName">
                        <span id="validEditUserFirstName" style="color:red;"></span>
                    </div>

                    <div class="col-6">
                        <label class="mt-3"> Last Name </label>
                        <input type="text" class="form-control" id="editUserLastName">
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <label class="mt-3"> Profile Text </label>
                        <input type="text" class="form-control" id="editUserText">
                    </div>
                </div>



                <div class="row">
                    <div class="col-6">
                        <label class="mt-3"> Email <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="editUserEmail" onblur="addValidEmail(event,'edit')">
                        <span id="validEditUserEmail" style="color:red;"></span>
                    </div>

                    <div class="col-6">
                        <label class="mt-3"> Password <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="editUserPassword" disabled>
                    </div>
                </div>

                <div class="row">
                    <div class="col-6">
                        <label class="mt-3"> Employee Id </label>
                        <input type="text" class="form-control" id="editUserEmployeeId">
                    </div>

                    <div class="col-6">
                        <label class="mt-3"> Department Name </label>
                        <input type="text" class="form-control" id="editUserDepartment">
                    </div>
                </div>



                <div class="row mt-2">
                    <div class="col-sm-3">
                        <label class="form-label">Country<span class="text-danger">*</span></label>

                        <select class="form-select" id="editUserCountry" onchange="GetCityUser('edit')">
                            @*<option value="@data.CountryId" selected>@data.Country.CountryName</option>*@
                            @if (ViewBag.CountryList != null)
                            {
                                @foreach (var country in ViewBag.CountryList)
                                {
                                    <option value="@country.CountryId">@country.CountryName</option>
                                }
                            }
                        </select>
                        <span id="validEditUserCountry" style="color:red;"></span>
                    </div>

                    <div class="col-sm-3">
                        <label class="form-label">City<span class="text-danger">*</span></label>
                        <select class="form-select" id="selectEditUserCityList">

                            <option id="selectCityUser">Please select first country</option>

                        </select>
                        <span id="validEditUserCity" style="color:red;"></span>
                    </div>

                    <div class="col-sm-3">
                        <label class="form-label">User Status<span class="text-danger">*</span></label>
                        <select class="form-select" id="editUserStatus">
                            <option value="true">Active</option>
                            <option value="false">InActive</option>
                        </select>
                    </div>

                    <div class="col-sm-3">
                        <label class="form-label">Role</label>
                        <select class="form-select" id="editUserRole">
                            <option value="User">User</option>
                            <option value="Admin">Admin</option>
                        </select>
                    </div>
                </div>
            </div>


            <div class="row my-3">
                <div class="col-xl-10 col-lg-8 col-md-8 col-sm-8 "></div>
                <div class="col-xl-2 col-lg-4 col-md-4 col-sm-4 ">
                    <button type="button" class="cancell rounded-pill btn btn-outline-dark"
                            onclick="editUserClose('nav-user');">
                        Cancel
                    </button>
                    <button type="submit" onclick="editValidUser(event)" class="btn rounded-pill applyButton editButton"
                            value="2" name="command">
                        Save
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>

<script>

    function addValidEmail(event,who) {
          event.preventDefault();
                debugger
          var email;
          if(who == "add")
          {
            email= $('#addUserEmail').val();
          }
          else
          {
              email= $('#editUserEmail').val();
          }
          if(email != '')
          {
          $.ajax({
            url: '/Admin/CheckEmail',
            type: 'POST',
            data: { email: email },
            success: function(result) {
                debugger
                  if (result === true) {
                      if(who == "add")
                      {
                                $('#validAddUserEmail').text('Email is already registered.');
                                $('.addButton').prop('disabled', true);
                      }
                      else
                      {
                          $('#validEditUserEmail').text('Email is already registered.');
                          $('.editButton').prop('disabled', true);
                      }
                  }
                  else
                  {
                      $('.addButton').prop('disabled', false);
                       $('.editButton').prop('disabled', false);
                  }
            }
          });
          }
}


    function addValidUser(event){

    var password = $('#addUserPassword').val();
    var minLength = 8;
    var hasUpperCase = /[A-Z]/.test(password);
    var hasLowerCase = /[a-z]/.test(password);
    var hasNumber = /\d/.test(password);
    var hasSpecialChar = /[!#$%@@^&*(),.?":{}|<>]/.test(password);



       



                event.preventDefault();
                var Firstname = $('#addUserFirstName').val().trim();
                var Email = $('#addUserEmail').val().trim();
                var CityId = $('#addUserCity').find(":selected").val();
                var CountryId = $('#addUserCountry').find(":selected").val();

                $('#validAddUserFirstName').text('');
                $('#validAddUserEmail').text('');
                $('#validAddUserCountry').text('');
                $('#validAddUserCity').text('');

                var isValid = true;

                 if (password.length < minLength) {
                  $('#validAddUserPassword').text('Password must be at least ' + minLength + ' characters long');
                  isValid = false;
                } 
                else if (!hasUpperCase) {
                  $('#validAddUserPassword').text('Password must contain at least one uppercase letter');
                  isValid = false;
                } 
                else if (!hasLowerCase) {
                  $('#validAddUserPassword').text('Password must contain at least one lowercase letter');
                  isValid = false;
                } 
                else if (!hasNumber) {
                  $('#validAddUserPassword').text('Password must contain at least one number');
                  isValid = false;
                } 
                else if (!hasSpecialChar) {
                  $('#validAddUserPassword').text('Password must contain at least one special character');
                  isValid = false;
                } 
                

                if (password === '') {
                    $('#passwordError').text('Please enter a new password.');
                    isValid = false;
                }

                if(Firstname == ""){
                    $('#validAddUserFirstName').text('First Name is Required!!');
                    isValid = false;
                } else {
                    $('#validAddUserFirstName').text('');
                }
                if(Email == ""){
                    $('#validAddUserEmail').text('Email is Required!!');
                    isValid = false;
                } else {
                    $('#validAddUserEmail').text('');
                }
                
                if(CityId == 0){
                    $('#validAddUserCity').text('Please Select a City!!');
                    isValid = false;
                } else {
                    $('#validAddUserCity').text('');
                }
                if(CountryId == 0){
                    $('#validAddUserCountry').text('Please Select a Country!!');
                    isValid = false;
                } else {
                    $('#validAddUserCountry').text('');
                }
    
                if (isValid) {
                    addUserData(event);
                }
}

    $('#addUserFirstName').keyup(function() {
        if ($(this).val() != '') {
            $('#validAddUserFirstName').text('');
        }
    });
    $('#addUserEmail').keyup(function() {
        if ($(this).val() != '') {
            $('#validAddUserEmail').text('');
        }
    });
    $('#addUserPassword').keyup(function() {
        if ($(this).val() != '') {
            $('#validAddUserPassword').text('');
        }
    });
    $('#addUserCity').change(function() {
        if ($(this).val() != 0) {
            $('#validAddUserCity').text('');
        }
    });
    $('#addUserCountry').change(function() {
        if ($(this).val() != 0) {
            $('#validAddUserCountry').text('');
        }
    });


    function editValidUser(event){
                    event.preventDefault();
                    var Firstname = $('#editUserFirstName').val().trim();
                    var Email = $('#editUserEmail').val().trim();
                    var Password = $('#editUserPassword').val().trim();
                    var CityId = $('#editUserCity').find(":selected").val();
                    var CountryId = $('#editUserCountry').find(":selected").val();

                    $('#validEditUserFirstName').text('');
                    $('#validEditUserEmail').text('');
                    $('#validEditUserPassword').text('');
                    $('#validEditUserCountry').text('');
                    $('#validEditUserCity').text('');

                    var isValid = true;

                    if(Firstname == ""){
                        $('#validEditUserFirstName').text('First Name is Required!!');
                        isValid = false;
                    } else {
                        $('#validEditUserFirstName').text('');
                    }
                    if(Email == ""){
                        $('#validEditUserEmail').text('Email is Required!!');
                        isValid = false;
                    } else {
                        $('#validEditUserEmail').text('');
                    }
                    if(Password == ""){
                        $('#validEditUserPassword').text('Password is Required!!');
                        isValid = false;
                    } else {
                        $('#validEditUserPassword').text('');
                    }
                    if(CityId == 0){
                        $('#validEditUserCity').text('Please Select a City!!');
                        isValid = false;
                    } else {
                        $('#validEditUserCity').text('');
                    }
                    if(CountryId == 0){
                        $('#validEditUserCountry').text('Please Select a Country!!');
                        isValid = false;
                    } else {
                        $('#validEditUserCountry').text('');
                    }
    
                    if (isValid) {
                        addUserData(event);
                    }
    }

    // Use keyup() function to remove the required message as soon as the user starts typing
    $('#editUserFirstName').keyup(function() {
        if ($(this).val() != '') {
            $('#validEditUserFirstName').text('');
        }
    });
    $('#editUserEmail').keyup(function() {
        if ($(this).val() != '') {
            $('#validEditUserEmail').text('');
        }
    });
    $('#editUserPassword').keyup(function() {
        if ($(this).val() != '') {
            $('#validEditUserPassword').text('');
        }
    });
    $('#editUserCity').change(function() {
        if ($(this).val() != 0) {
            $('#validEditUserCity').text('');
        }
    });
    $('#editUserCountry').change(function() {
        if ($(this).val() != 0) {
            $('#validEditUserCountry').text('');
        }
    });




    // listen for changes to the file input
    $('#addUserAvatar').on('change', function() {
        // get the selected file
        var file = this.files[0];
    
        // create a URL for the selected file
        var url = URL.createObjectURL(file);
    
        // create an img element and set its src attribute
        var img = $('<img>').attr({
            'id': 'addUserDefaultAvatar',
            'src': url,
            'class': 'rounded-circle',
            'style': 'height: 150px; max-width: 150px;'
        });
    
        // remove the old image and append the new one
        $('#addUserDefaultAvatar').remove();
        $('#addUserPop').append(img);
    });


    $('#editUserAvatar').on('change', function() {
        $('#editUserAvatarImg').remove();
        // get the selected file
        var file = this.files[0];
    
        // create a URL for the selected file
        var url = URL.createObjectURL(file);
    
        // create an img element and set its src attribute
        var img = $('<img>').attr({
            'id': 'editUserAvatarImg',
            'src': url,
            'class': 'rounded-circle',
            'style': 'height: 150px; max-width: 150px;margin-top: -238px;'
        });
    
        // remove the old image and append the new one
        $('#editUserPop').append(img);
    });


    function getUserData(userId)
        {
            console.log(userId);
            debugger
            $.ajax({
                         type: 'POST',
                         url: '/Admin/EditUser',
                         data: {"UserId": userId},
                         success: function(data) {
                             console.log(data);
                             debugger
                            
                             $('#userId').val(data.userId);
                             $('#editUserFirstName').val(data.firstName);
                             $('#editUserLastName').val(data.lastName);
                             $('#editUserEmail').val(data.email);
                             $('#editUserPassword').val(data.password);
                             $('#editUserEmployeeId').val(data.employeeId);
                             $('#editUserDepartment').val(data.department);
                             $('#editUserCountry').val(data.countryId);
                             $('#editUserCity').val(data.cityId);
                             $('#editUserRole').val(data.role.trim());
                             $('#editUserText').val(data.profileText);
                             $('#editUserStatus').val((data.status).toString());

                             var img = $('<img>').attr({
                                    'id': 'editUserAvatarImg',
                                    'src': '../Assets/StoryImages/' + data.avatar,
                                    'class': 'rounded-circle',
                                    'style': 'height: 150px; max-width: 150px;margin-top: -238px;'
                                });
                                $('#editUserPop').append(img);
                                GetCityUser('edit');


                         },
                        error: function (request, error) {
                         console.log(error);
                     }
                     });
        }

    function addUserData(event) {
           debugger
           
             var userId = $('#userId').val();

                        if(userId != 0)
                        {

                             event.preventDefault();
                             var formData = new FormData();
                            formData.append('UserId', $('#userId').val());
                            formData.append('FirstName', $('#editUserFirstName').val());
                            formData.append('LastName', $('#editUserLastName').val());
                            formData.append('Email', $('#editUserEmail').val());
                            formData.append('Password', $('#editUserPassword').val());
                            formData.append('UserImg', $('#editUserAvatar')[0].files[0]);
                            formData.append('EmployeeId', $('#editUserEmployeeId').val());
                            formData.append('Department', $('#editUserDepartment').val());
                            formData.append('CityId', $('#editUserCity').val());
                            formData.append('Role', $('#editUserRole').val());
                            formData.append('CountryId', $('#editUserCountry').val());
                            formData.append('ProfileText', $('#editUserText').val());
                            formData.append('Status', $('#editUserStatus').val());
                        }
                        else
                        {
                            var Profileimg = $('#addUserAvatar')[0].files[0];

                             event.preventDefault();
                             var formData = new FormData();
                            formData.append('FirstName', $('#addUserFirstName').val());
                            formData.append('LastName', $('#addUserLastName').val());
                            formData.append('Email', $('#addUserEmail').val());
                            formData.append('Password', $('#addUserPassword').val());
                            formData.append('UserImg', $('#addUserAvatar')[0].files[0]);
                            formData.append('EmployeeId', $('#addUserEmployeeId').val());
                            formData.append('Department', $('#addUserDepartment').val());
                            formData.append('CityId', $('#addUserCity').val());
                            formData.append('Role', $('#addUserRole').val());
                            formData.append('CountryId', $('#addUserCountry').val());
                            formData.append('ProfileText', $('#addUserText').val());
                            formData.append('Status', $('#addUserStatus').val());

                      }
                   
                             $.ajax({
                                 type: 'POST',
                                 url: '/Admin/AddUser',
                                 data: formData,
                                 contentType: false,
                                 processData: false,
                                 success: function(data) {
                                     debugger
                                     userView('nav-user');
                                     console.log(data);
                                     $('#users').html(data);
                                     searchMission(@ViewBag.pg_no,'user');

                                     if(userId != 0)
                                     {
                                         toastr.success('User edited');
                                     }
                                     else
                                     {
                                        toastr.success('User add sucessfully');
                                     }

                                 },
                                 error: function (request, error) {
                                 console.log(error);
                                 }
                             });
     }

    function EditAvatar(){
            
                    debugger
                    var Profileimg = $('#addUserAvatar')[0].files[0];
                    console.log(Profileimg);

                    var data = new FormData();
                    data.append('Profileimg',Profileimg);

                    //$.ajax({

                    //      url: '/User/EditAvatar',
                    //      type: 'POST',
                    //      data: data,
                    //      processData: false,
                    //      contentType: false,
                    //      success: function(response) {
                    //        console.log(response);
                    //         localStorage.setItem('avatarChanged', 'true');
                    //        location.reload();
                    //      },
                    //      error: function(error) {
                    //        console.log(error);
                    //      }
                    //                      });
    
                }

    function GetCityUser(x) {
                    debugger
                     var who = x;
                     var countryId = 0;
                     debugger
                                if(who == 'edit')
                                {
                                  countryId = $("#editUserCountry").val();
                                }
                                
                                else
                                {
                                  countryId = $("#addUserCountry").val();
                                }
                                

                                    $.ajax({
                                        url: "/User/GetCity",
                                        method: "Post",
                                        data: {"countryId": countryId},
                                        success: function (data) {
                                            data = JSON.parse(data);
                                            console.log(data);
                                            debugger
                                       @* if(who == 'edit')
                                        {

                                            $("#selectUserCityList").empty();
                                            data.forEach((name) => {
                                                document.getElementById("selectUserCityList").innerHTML += `

                                            <option class="form-check" value="${name.CityId}" name="city" id="editUserCity">${name.CityName}</option>

                                                `;
                                            })
                                        }*@
                                        if(who == 'edit')
                                        {

                                            $("#selectEditUserCityList").empty();
                                            data.forEach((name) => {
                                                document.getElementById("selectEditUserCityList").innerHTML += `

                                            <option class="form-check" value="${name.CityId}" name="city" id="editUserCity">${name.CityName}</option>

                                                `;
                                            })
                                        }
                                        else
                                        {
                                            $("#selectUserCityList").empty();
                                             data.forEach((name) => {
                                            document.getElementById("selectUserCityList").innerHTML += `

                                            <option class="form-check" value="${name.CityId}" name="city" id="addUserCity">${name.CityName}</option>

                                                `;
                                                    })
                                        }
                                        },
                                        error: function (request, error) {
                                            console.log(error);
                                        }
                                    })
         }

    function deleteUser(userId,event)
        {
            
             debugger
             event.preventDefault();
                $.ajax({
                         type: 'POST',
                         url: '/Admin/DeleteUser',
                         data: {"UserId": userId},
                         success: function(data) {
                             console.log(data);
                             debugger
                             userView('nav-user');
                             console.log(data);
                             $('#users').html(data);
                             searchMission(@ViewBag.pg_no,'user');
                             toastr.error('User Deleted');
                         },
                        error: function (request, error) {
                         console.log(error);
                     }
                     });
        }

        function addUser(x) {
            var page = document.getElementById(x);
            var userpage = page.querySelector("#userpage");
            var addUser = page.querySelector("#add");
            var search = page.querySelector("#searchUser1");
            search.style.display = "none";
            userpage.style.display = "none";
            addUser.style.display = 'block';
        }
        function userView(x) {
            debugger
            var page = document.getElementById(x);
            var userpage = page.querySelector("#userpage");
            var addUser = page.querySelector("#add");
            var search = page.querySelector("#searchUser1");
            search.style.display = "block";
            userpage.style.display = "block";
            addUser.style.display = 'none';
        }
        function editUser(x,id) {
           debugger
            var page = document.getElementById(x);
            var userpage = page.querySelector("#userpage");
            var addUser = page.querySelector("#edit");
            var search = page.querySelector("#searchUser1");
            search.style.display = "none";
            userpage.style.display = "none";
            addUser.style.display = 'block';
            getUserData(id);
        }
        function editUserClose(x) {
            debugger
            $('#editUserAvatarImg').remove();
            var page = document.getElementById(x);
            var userpage = page.querySelector("#userpage");
            var addUser = page.querySelector("#edit");
            var search = page.querySelector("#searchUser1");
            search.style.display = "block";
            userpage.style.display = "block";
            addUser.style.display = "none";
        }
</script>