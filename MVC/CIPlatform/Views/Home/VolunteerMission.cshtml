@if (TempData["Error"] != null)
{

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <script type="text/javascript">

        toastr.error('@TempData["Error"]')
    </script>

}

@if (TempData["Success"] != null)
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script type="text/javascript">
         toastr.options = {
            "closeButton": true
        }
        toastr.success('@TempData["Success"]', { timeOut: 100 })
    </script>

}
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link rel="stylesheet" href="~/Assets/css/volunteermission.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" />
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <!-- Toastr library -->

    <script src="~/js/site.js"></script>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

    <!-- jQuery library -->
    <style>
        .rating1 {
            display: flex;
            justify-content: center;
            background-color: white;
        }

            .rating1 > label {
                position: relative;
                width: 1em;
                font-size: 20px;
                color: #F88634;
                cursor: pointer
            }



        .rating ::before
        {
        display: flex;
        justify-content: center;
        background-color: white;
        }

        .rating > input {
            display: none
        }

        .rating > label {
            position: relative;
            width: 1em;
            font-size: 30px;
            color: #F88634;
            cursor: pointer
        }

            .rating > label::before {
                content: "\2605";
                position: absolute;
                opacity: 0
            }

            .rating > label:hover::before,
            .rating > label:hover {
                opacity: 1 !important;
                color: #F88634;
            }


        .disc_stars {
            width: fit-content;
            background: #ffffff;
            display: block;
            margin: auto;
            transform: translateY(-100%);
        }
         .card-imgs {
        height: 250px;
        max-height: 250px !important;
    }
    </style>
</head>
<body>

    <partial name="_FirstNav" />
    <div class="container">

        <div class="row bootstrap snippets">

            @*<div class="col-xl-6 col-lg-6  col-12 ">
                <div style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff" class="swiper mySwiper2">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide">
                            <img src="~/Assets/images/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-4.png" />
                        </div>
                        <div class="swiper-slide">
                            <img src="~/Assets/images/img.png" />
                        </div>
                        <div class="swiper-slide">
                            <img src="~/Assets/images/Plantation-and-Afforestation-programme.png" />
                        </div>
                        <div class="swiper-slide">
                            <img src="~/Assets/images/img11.png" />
                        </div>

                    </div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                </div>
                <div thumbsSlider="" class="swiper mySwiper row d-flex flex-row">
                    <div class="swiper-wrapper  ">
                        <div class="swiper-slide col-3">
                            <img src="~/Assets/images/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-4.png" />
                        </div>
                        <div class="swiper-slide col-3">
                            <img src="~/Assets/images/img.png" />
                        </div>
                        <div class="swiper-slide col-3">
                            <img src="~/Assets/images/Plantation-and-Afforestation-programme.png" />
                        </div>
                        <div class="swiper-slide col-3">
                            <img src="~/Assets/images/img11.png" />
                        </div>

                    </div>
                </div>

                <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />
                <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

                <!-- Swiper JS -->
                <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

                <!-- Initialize Swiper -->
                <script>
                    var swiper = new Swiper(".mySwiper", {
                        loop: true,
                        spaceBetween: 10,
                        slidesPerView: 4,
                        freeMode: true,
                        watchSlidesProgress: true,
                    });
                    var swiper2 = new Swiper(".mySwiper2", {
                        loop: true,
                        spaceBetween: 10,
                        navigation: {
                            nextEl: ".swiper-button-next",
                            prevEl: ".swiper-button-prev",
                        },
                        thumbs: {
                            swiper: swiper,
                        },
                    });
                </script>
            </div>*@

              <div class="col-xl-6 col-lg-6  col-12 ">
                        <div style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff" class="swiper mySwiper2">
                            <div class="swiper-wrapper pb-5">

                                @foreach (string imageUrl in ViewBag.missionDatas.MissionImages)
                                {
                                    <div class="swiper-slide">
                                        <img src="~/Assets/StoryImages/@imageUrl" />
                                    </div>

                                }
                                @if (ViewBag.missionDatas != null)
                                {
                                    @if (ViewBag.missionDatas.VideoUrl != null)
                                    {
                                        @foreach (var i in ViewBag.missionDatas.MissionVideoUrl)
                                        {
                                            string embedLink = @i.Replace("watch?v=", "embed/");
                                            <div class="swiper-slide">
                                                <iframe width="560" height="315" src="@embedLink" title="YouTube video player" frameborder="0"></iframe>
                                            </div>
                                        }
                                    }

                                }


                            </div>
                            <div class="swiper-button-next text-black"></div>
                            <div class="swiper-button-prev text-black"></div>
                        </div>
                        <div thumbsSlider="" class="swiper mySwiper row d-flex flex-row">
                            <div class="swiper-wrapper  ">
                                @foreach (string imageUrl in ViewBag.missionDatas.MissionImages)
                                {
                                    <div class="swiper-slide">
                                        <img src="~/Assets/StoryImages/@imageUrl" />
                                    </div>

                                }
                                @if (ViewBag.missionDatas != null)
                                {
                                    @if (ViewBag.missionDatas.VideoUrl != null)
                                    {
                                        @foreach (var i in ViewBag.missionDatas.MissionVideoUrl)
                                        {
                                            string embedLink = @i.Replace("watch?v=", "embed/");
                                            <div class="swiper-slide">
                                                <iframe width="200" height="125" src="@embedLink" title="YouTube video player" frameborder="1" allowfullscreen></iframe>
                                            </div>
                                        }
                                    }

                                }

                            </div>
                        </div>

                        <!-- Swiper JS -->
                        <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

                        <!-- Initialize Swiper -->
                        <script>
                            var swiper = new Swiper(".mySwiper", {
                                loop: true,
                                spaceBetween: 10,
                                slidesPerView: 4,
                                freeMode: true,
                                watchSlidesProgress: true,
                            });
                            var swiper2 = new Swiper(".mySwiper2", {
                                loop: true,
                                spaceBetween: 10,
                                navigation: {
                                    nextEl: ".swiper-button-next",
                                    prevEl: ".swiper-button-prev",
                                },
                                thumbs: {
                                    swiper: swiper,
                                },
                            });
                        </script>
                    </div>

            <div class="col-xl-6 col-lg-6  col-12 pt-2">
                <div class="col-lg-12 col-md-12 col-sm-12 hidden-xs">
                    <div class="thumbnail col-lg-12 col-md-12 col-sm-12 ">

                        <div class=" pt-2 ">

                            <h3>
                                @ViewBag.missionDatas.Title
                            </h3>

                            <p>@ViewBag.missionDatas.ShortDescription</p>

                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"></li>
                                <li class="list-group-item">
                                    <div class=" text-center py-3" style="margin-top: -45px; ">
                                        @if (@ViewBag.missionDatas.MissionType == "Goal")
                                        {
                                            <button class="btn rounded-5  " style="border-color: black; background: white; z-index:4;">@ViewBag.missionDatas.MissionGoalText</button>
                                        }
                                        else
                                        {
                                            <button class="btn rounded-5  " style="border-color: black; background: white; z-index:4;"> From @ViewBag.missionDatas.StartDate.ToString("dd/MM/yyyy") untill @ViewBag.missionDatas.EndDate.ToString("dd/MM/yyyy")</button>
                                        }
                                    </div>
                                    <div class="row">
                                        @if (@ViewBag.missionDatas.MissionType == "Goal")
                                        {

                                            var a = @ViewBag.missionDatas.GoalValue1;
                                            <div class="col-6 ">
                                                <div class="card  border-0">
                                                    <div class="d-flex justify-content-center align-items-center">
                                                        <img src="~/Assets/images/achieved.png" />
                                                        <div class="flex-column px-2" style="font-size:smaller; font-weight:400">
                                                            <div class="progress">
                                                                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: @a%; background-color:#F88634;"></div>
                                                            </div>
                                                            <div> <span class="">@ViewBag.missionDatas.CompletedGoal achieved</span> </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="col-6 ">
                                                <div class="card  border-0">
                                                    <div class=" d-flex flex-row">
                                                        <div class=""><img src="~/Assets/images/Seats-left.png" class="img-fluid"></div>
                                                        <div class=" ">
                                                            <h5 class="card-title" style="text-transform: capitalize;"> &nbsp; @ViewBag.missionDatas.TotalSeats</h5>
                                                            <p class="card-text ">Seats left</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                        <div class="col-6">
                                            <div class="card  border-0">
                                                <div class=" d-flex flex-row">
                                                    <div class=""><img src="~/Assets/images/deadline.png" class="img-fluid"></div>
                                                    <div class=" ">
                                                        <h6 class="card-title">@ViewBag.missionDatas.Deadline.ToString("dd/MM/yyyy")</h6>
                                                        <p class="card-text ">Deadline</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item p-4  ">
                                    <div class="row">
                                        <div class="col-xl-6 col-12 text-center ">
                                            @if (@ViewBag.CheckFavMisson == true)
                                            {
                                                <button type="submit" class="btn rounded-5" onclick="Add(@ViewBag.missionDatas.MissionId, 'btnAddToFavVolun_')" style="border-color: black;"><i class="bi bi-heart-fill  text-danger" id="addToFavVolun_@ViewBag.missionDatas.MissionId"></i>&nbsp;<span id="favButtonText">Remove from Favourite</span></button>
                                            }
                                            else
                                            {
                                                <button type="submit" onclick="Add(@ViewBag.missionDatas.MissionId, 'btnAddToFavVolun_')" class="btn rounded-5  " style="border-color: black;"><i id="addToFavVolun_@ViewBag.missionDatas.MissionId" class="bi bi-heart"></i>&nbsp;<span id="favButtonText">Add to favourite</span></button>
                                            }
                                        </div>
                                        <div class="col-xl-6 col-12 text-center  ">
                                            <button type="submit" class="btn rounded-5  " style="border-color: black;" data-bs-toggle="modal" data-bs-target="#exampleModal"><img src="~/Assets/images/add1.png" class=" img-fluid cancle-img" alt=""> &nbsp;Recommand Co-Worker</button>

                                            <!-- Modal -->
                                            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="exampleModalLabel">Co-Worker List</h5>

                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                                                        </div>
                                                        <table class="table">
                                                            <thead>
                                                                <tr>
                                                                    <th>Select</th>
                                                                    <th>Name</th>
                                                                    <th>Email</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @foreach (var worker in @ViewBag.Users)
                                                                {
                                                                    <tr>
                                                                        <td>
                                                                            <div class="form-check">
                                                                                <input class="form-check-input" onclick="CheckUser(@worker.UserId,@ViewBag.missionDatas.MissionId)" name="CoWorkers" type="checkbox" value="@worker.FirstName" id="@worker.UserId" />
                                                                                <input type="hidden" id="uid" value="@worker.UserId" />
                                                                            </div>
                                                                        </td>
                                                                        <td>@worker.FirstName @worker.LastName</td>
                                                                        <td>@worker.Email</td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                            <tfoot>
                                                                <tr>
                                                                    <td colspan="3">
                                                                        <button type="button" class=" rounded-pill btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
                                                                        <button type="submit" onclick="sendInvitation(@ViewBag.missionDatas.MissionId)" class="btn applyButton" data-bs-dismiss="modal">Send Invitation</button>
                                                                    </td>
                                                                </tr>
                                                            </tfoot>
                                                        </table>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </li>

                                <li class="list-group-item">
                                    <div class="rating disc_stars text-center" style="margin-top: 15px; z-index:5;">


                                        @for (var j = 1; j <= (@ViewBag.missionDatas.UserRating); j++)
                                        {
                                            <label class="rtcolor checked" style="color: #F88634; text-shadow: 0 0 0 #F88634;" data-mission-id="@j" onclick="Rate(@j,@ViewBag.missionDatas.MissionId)">&#9733;</label>
                                        }
                                        @for (int j = (@ViewBag.missionDatas.UserRating) + 1; j <= 5; j++)
                                        {
                                            <label class="rtcolor text-black" data-mission-id="@j" onclick="Rate(@j,@ViewBag.missionDatas.MissionId)">☆</label>
                                        }


                                    </div>
                                </li>
                            </ul>

                            <div class="row">
                                <div class="col-xl-3 col-md-3 col-6 border-1">
                                    <div class="card p-xl-2  p-2  p-lg-0 ">
                                        <div class=" d-flex flex-row">
                                            <div class="">
                                                <img src="~/Assets/images/pin1.png" class="img-fluid">
                                                <br><br class="d-xl-block d-lg-none" />
                                                <p class="card-title pt-xl-0 pt-lg-0 pt-md-3" style="text-transform: capitalize;">City</p>
                                                <h6 class="card-text ">@ViewBag.missionDatas.CityName</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-3 col-md-3 col-6 border-1">
                                    <div class="card p-xl-2  p-2  p-lg-0 ">
                                        <div class=" d-flex flex-row">
                                            <div class="">
                                                <img src="~/Assets/images/web.png" class="img-fluid">
                                                <br><br class="d-xl-block d-lg-none" />
                                                <p class="card-title pt-xl-0 pt-lg-0 pt-md-3" style="text-transform: capitalize;">Theme</p>
                                                <h6 class="card-text ">@ViewBag.missionDatas.Theme</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-3 col-md-3 col-6 border-1 pt-lg-0 pt-md-0 pt-2">
                                    <div class="card p-xl-2  p-2  p-lg-0 ">
                                        <div class=" d-flex flex-row">
                                            <div class="">
                                                <img src="~/Assets/images/calender.png" class="img-fluid">
                                                <br><br class=" d-lg-none" />
                                                <p class="card-title pt-xl-2 " style="text-transform: capitalize;">Date</p>
                                                <h6 class="card-text ">@ViewBag.missionDatas.Deadline.ToString("dd/MM/yyyy")</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-3 col-md-3 col-6 border-1 pt-lg-0 pt-md-0 pt-2">
                                    <div class="card p-xl-2  p-2 p-lg-0">
                                        <div class=" d-flex flex-row">
                                            <div class="">
                                                <img src="~/Assets/images/organization.png" class="img-fluid">
                                                <br><br class="d-xl-block d-lg-none" />
                                                <p class="card-title pt-xl-0 pt-lg-0 pt-md-3" style="text-transform: capitalize;">Organization</p>
                                                <h6 class="card-text ">@ViewBag.missionDatas.OrganizationName</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class=" text-center pt-3">

                                @if (@ViewBag.missionDatas.TotalSeats == 0)
                                {
                                    <button type="button" disabled class="btn applyButton ">Sorry seats left !!</button>
                                }
                                @*else if(@ViewBag.missionDatas.IsApplied == 1)
                                {
                                    <button type="submit" onclick="ApplyMission(@ViewBag.missionDatas.MissionId)" class="btn applyButton " disabled> Alredy Applied</button>
                                }*@
                                else if(@ViewBag.missionDatas.Status == "Decline")
                                {
                                    <button type="submit" onclick="ApplyMission(@ViewBag.missionDatas.MissionId)" class="btn applyButton " disabled> Request Declined &nbsp; &nbsp; <i class="bi bi-clock-history"></i></button>
                                }
                                else if(@ViewBag.missionDatas.IsApplied == 1)
                                {
                                    <button type="submit"  class="btn applyButton " disabled> Alredy Applied</button>
                                }
                                 else if(@ViewBag.missionDatas.Deadline < @DateTime.Now)
                                {
                                    <button type="submit" class="btn applyButton " disabled> Registration Date Over &nbsp; &nbsp; <i class="bi bi-clock-history"></i></button>
                                }
                                else
                                {
                                    <button type="submit" onclick="ApplyMission(@ViewBag.missionDatas.MissionId)" class="btn applyButton "> Apply &nbsp; &nbsp; <i class="bi bi-arrow-right"></i></button>
                                }
                            </div>


                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-5">

            <div class="col-lg-8">

                <nav>

                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <button class=" btn applyButton  active " id="nav-home-tab" data-bs-toggle="tab"
                                data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home"
                                aria-selected="true">
                            Mission
                        </button>
                        <button class=" btn applyButton " id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile"
                                type="button" role="tab" aria-controls="nav-profile" aria-selected="false">
                            Organization
                        </button>
                        <button class=" btn applyButton" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact"
                                type="button" role="tab" aria-controls="nav-contact" aria-selected="false">
                            Comments
                        </button>
                    </div>

                </nav>

                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                        <h4 class="pt-3 pb-2">Introduction</h4>@ViewBag.missionDatas.ShortDescription
                        <h4 class="pt-3 pb-2">Challenge</h4>
                        recusandae commodi error corporis voluptatem architecto, a placeat eveniet neque? Sequi!Lorem, ipsum dolor sit amet consectetur adipisicing elit. Mollitia ipsum ratione quae! Earum,
                        atque quidem! Suscipit architecto, itaque, quae quia quaerat eligendi blanditiis sequi tempore
                        veritatis aliquid id voluptates unde inventore alias dolorum et modi, fuga vitae possimus. Quam
                        recusandae commodi error corporis voluptatem architecto, a placeat eveniet neque? Sequi!Lorem, ipsum dolor sit amet consectetur adipisicing elit. Mollitia ipsum ratione quae! Earum,
                        atque quidem! Suscipit architecto, itaque, quae quia quaerat eligendi blanditiis sequi tempore
                        veritatis aliquid id voluptates unde inventore alias dolorum et modi, fuga vitae possimus. Quam
                        recusandae commodi error corporis voluptatem architecto, a placeat eveniet neque? Sequi!Lorem, ipsum dolor sit amet consectetur adipisicing elit. Mollitia ipsum ratione quae! Earum,
                        atque quidem! Suscipit architecto, itaque, quae quia quaerat eligendi blanditiis sequi tempore
                        veritatis aliquid id voluptates unde inventore alias dolorum et modi, fuga vitae possimus. Quam
                        recusandae commodi error corporis voluptatem architecto, a placeat eveniet neque? Sequi!Lorem, ipsum dolor sit amet consectetur adipisicing elit. Mollitia ipsum ratione quae! Earum,
                        atque quidem! Suscipit architecto, itaque, quae quia quaerat eligendi blanditiis sequi tempore
                        veritatis aliquid id voluptates unde inventore alias dolorum et modi, fuga vitae possimus. Quam
                        recusandae commodi error corporis voluptatem architecto, a placeat eveniet neque? Sequi!Lorem, ipsum dolor sit amet consectetur adipisicing elit. Mollitia ipsum ratione quae! Earum,
                        atque quidem! Suscipit architecto, itaque, quae quia quaerat eligendi blanditiis sequi tempore
                        veritatis aliquid id voluptates unde inventore alias dolorum et modi, fuga vitae possimus. Quam
                        recusandae commodi error corporis voluptatem architecto, a placeat eveniet neque? Sequi!
                        <h4 class="pt-3 pb-2"> Documents </h4>

                        <div class="row">

                            @if (ViewBag.missionDatas.Documents != null)
                            {
                                foreach (var document in ViewBag.missionDatas.Documents)
                                {
                                    
                                <div class="col-xl-6 col-12 text-center ">
                                    <a type="submit" target="_blank" href="/Assets/Document/@document" class="btn rounded-5  " style="border-color: black;"><img src="~/Assets/images/pdf.png" class=" img-fluid cancle-img" alt="">@document</a>
                                </div>
                                }
                            }
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                        Lorem
                        ipsum dolor sit amet consectetur adipisicing elit. Sapiente laboriosam, voluptatem alias
                        doloribus ea voluptate libero eos fugit nemo cum quidem dolorum nam eaque reiciendis, cupiditate
                        pariatur laudantium optio, molestiae reprehenderit hic! Hic, beatae cumque harum excepturi rem,
                        animi minima eius porro sequi doloremque incidunt distinctio enim ipsam quis in.
                    </div>
                    <partial name="_Comment" />
                </div>
            </div>

            <div class="col-lg-4 pt-xl-0 pt-4">
                <div class="col-12 border p-4">
                    <h3>Information </h3>
                    <hr />
                    <div class="row">
                        <div class="col-4">
                            <span>Skills</span>
                        </div>
                        <div class="col-8">
                            <span>@ViewBag.missionDatas.SkillName</span>
                        </div>
                    </div>
                    <hr />
                    <div class="row">
                        <div class="col-4">
                            <span>Days</span>
                        </div>
                        <div class="col-8">
                            <span>Weekend only</span>
                        </div>
                    </div>
                    <hr />
                    <div class="row">
                        <div class="col-4">
                            <span>Rating</span>
                        </div>
                        <div class="col-8">
                            <span class="rating1  text-center">

                                @if (true)
                                {
                                    for (var i = 0; i < (@ViewBag.missionDatas.AvgRating); i++)
                                    {
                                        <label style="color: #F88634; text-shadow: 0 0 0 #F88634;">&#9733;</label>
                                    }
                                    for (var i = 0; i < 5 - (@ViewBag.missionDatas.AvgRating); i++)
                                    {
                                        <label style="color: black;">☆</label>
                                    }
                                }
                                (by @ViewBag.missionDatas.CommentByUser volunteers)

                            </span>
                        </div>
                    </div>
                </div>
                <br />
                <div id="volunteer">
                    <partial name="_RecentVolunteer" />
                </div>
            </div>
        </div>


        <br />
        <br />
        <hr />

        <div class="row g-0">
            <h3 class="text-center">Related Missions</h3>
            <br />



            @foreach (var item in @ViewBag.relatedmission)
            {
             <div class="col-xl-4 col-lg-6 col-md-6 col-sm-6 col-12 pb-3 p-2" style="">
                @* <div class="hidden-xs">*@
                <div class="thumbnail h-100">
                    <div class="card h-100">
                        <img src="~/Assets/StoryImages/@item.MediaName" class="img-fluid card-imgs">
                        <div class="position-relative">
                            <div class="position-absolute top-100 start-50 translate-middle rounded-5 p-2" style="background-color: white;">@item.Theme</div>
                        </div>
                        <div class="card-img-overlay ">
                            <div class="d-flex flex-column  text-end pb-5" style="margin-inline: auto;">
                                <div class="">
                                    <button class="btn rounded-5 border" style="background-color:black; opacity:70%;">
                                        <img src="~/Assets/images/pin.png" class="img-fluid cancle-img" alt="">
                                        <span style="color:white;">@item.CityName</span>
                                    </button>
                                </div>
                                <div class="pt-1">
                                    @if (@item.IsFavMission == 1)
                                    {

                                        <button type="submit" onclick="Add(@item.MissionId, 'btnAddToFavGrid_')" class="btn rounded-5 border-light" style="background-color:black; opacity:70%;"><i class="bi bi-heart-fill  text-danger" id="addToFavGrid_@item.MissionId"></i></button>
                                    }
                                    else
                                    {
                                        <button type="submit" onclick="Add(@item.MissionId, 'btnAddToFavGrid_')" class="btn rounded-5  border-light" style="background-color:black; opacity:70%;"><i id="addToFavGrid_@item.MissionId" class="bi bi-heart text-white"></i></button>
                                    }

                                </div>
                                <div class="">
                                    @*    <button class="btn btn-box rounded-5 border-light" >
                                        <img src="~/Assets/images/user.png" class=" img-fluid cancle-img" alt="">
                                        </button>*@

                                    <button type="submit" class="btn rounded-5  border-light" data-bs-toggle="modal" data-bs-target="#exampleModal_@item.MissionId" style="background-color:black; opacity:70%;"><img src="~/Assets/images/user.png" class=" img-fluid cancle-img" alt=""> </button>

                                    <!-- Modal -->
                                <div class="modal fade" id="exampleModal_@item.MissionId" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Co-Worker List</h5>

                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                                                </div>
                                                <table class="table">
                                                    <thead>
                                                        <tr>
                                                            <th>Select</th>
                                                            <th>Name</th>
                                                            <th>Email</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (var worker in @ViewBag.Users)
                                                        {
                                                            <tr>
                                                                <td>
                                                                    <div class="form-check">
                                                                        <input class="form-check-input" name="CoWorkers" type="checkbox" onclick="CheckUser(@worker.UserId,@item.MissionId)" value="@worker.FirstName" id="@worker.UserId" />
                                                                        <input type="hidden" id="uid" value="@worker.UserId" />
                                                                    </div>
                                                                </td>
                                                                <td>@worker.FirstName @worker.LastName</td>
                                                                <td>@worker.Email</td>
                                                            </tr>
                                                        }
                                                    </tbody>
                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="3">
                                                                <button type="button" class=" rounded-pill btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
                                                                <button type="submit" onclick="sendInvitation(@item.MissionId)" class="btn applyButton" data-bs-dismiss="modal">Send Invitation</button>
                                                            </td>
                                                        </tr>
                                                    </tfoot>
                                                </table>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-3" style="z-index:1; border: solid; border-width: thin;border-top:none;border-bottom:none; border-color:lightgray">
                            <h3>@item.Title</h3>
                            <p>@item.ShortDescription</p>
                            <div class="d-flex rating1">
                                <div><h5>@item.OrganizationName</h5></div>
                                <div class="col d-flex justify-content-end">
                                    <span class="rating  text-center">

                                        @for (var i = 0; i < (@item.AvgRating); i++)
                                        {
                                            <label style="color: #F88634; text-shadow: 0 0 0 #F88634;">&#9733;</label>
                                        }
                                        @for (var i = 0; i < 5 - (@item.AvgRating); i++)
                                        {
                                            <label style="color: black;">☆</label>
                                        }

                                    </span>
                                </div>
                            </div>
                            <br>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"></li>
                                <li class="list-group-item">
                                    <div class=" text-center py-3" style="margin-top: -45px; ">
                                        @if (@item.MissionType == "Goal")
                                        {
                                            <button type="submit" href="#" class="btn rounded-5  " style="border-color: black; background: white">@item.MissionGoalText</button>
                                        }
                                        else
                                        {
                                            <button type="submit" href="#" class="btn rounded-5  " style="border-color: black; background: white"> From @item.StartDate.ToString("dd/MM/yyyy") untill @item.EndDate.ToString("dd/MM/yyyy")</button>
                                        }
                                    </div>
                                    <div class="row">
                                        @if (@item.MissionType == "Goal")
                                        {
                                            var a = @item.GoalValue1;
                                            <div class="col-6 ">
                                                <div class="card  border-0">
                                                    <div class="d-flex justify-content-center align-items-center">
                                                        <img src="~/Assets/images/achieved.png" />
                                                        <div class="flex-column px-2" style="font-size:smaller; font-weight:400">
                                                            <div class="progress">
                                                                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: @a%; background-color:#F88634;"></div>
                                                            </div>
                                                            <div> <span class="">@item.CompletedGoal achieved</span> </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="col-6 ">
                                                <div class="card  border-0">
                                                    <div class=" d-flex flex-row">
                                                        <div class=""><img src="~/Assets/images/Seats-left.png" class="img-fluid"></div>
                                                        <div class=" ">
                                                            <h5 class="card-title" style="text-transform: capitalize;">&nbsp;@item.TotalSeats</h5>

                                                            <p class="card-text ">Seats left</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                        <div class="col-6">
                                            <div class="card  border-0">
                                                <div class=" d-flex flex-row">
                                                    <div class=""><img src="~/Assets/images/deadline.png" class="img-fluid"></div>
                                                    <div class=" ">
                                                        <h6 class="card-title"> @item.Deadline.ToString("dd/MM/yyyy")</h6>
                                                        <p class="card-text ">Deadline</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item"></li>
                            </ul>
                            <div class=" text-center pb-2" >
                                @if (@item.IsApplied == 1)
                                {
                                    <a asp-controller="Home" class="btn applyButton " asp-action="VolunteerMission" asp-route-id="@item.MissionId" style="z-index:1;">
                                        View Detail &nbsp; &nbsp; <i class="bi bi-arrow-right"></i>
                                    </a>
                                }
                                else
                                {
                                    @*onclick="window.location= '@Url.Action( "VolunteerMission", "Home", new {id = @item.MissionId})'"*@
                                    <a asp-controller="Home" class="btn applyButton " asp-action="VolunteerMission" asp-route-id="@item.MissionId" style="z-index:1;">
                                        Apply &nbsp; &nbsp; <i class="bi bi-arrow-right"></i>
                                    </a>
                                }
                            </div>
                        </div>
                    </div>

                </div>
                @*  </div>*@
            </div>

            }
        </div>
    </div>



</body>
<script>


function Rate(i,MissionId)
          {
              $(".rtcolor").removeClass("text-warning");
              PostRating(i,MissionId);
          }

function PostRating(i,MissionId) {


            debugger

            $.ajax({
                type: "POST",
                url: '/Home/PostRating',
                data: {
                    'rate': i,
                    'MissionId': MissionId

                },
                success: (data) => {
                    if(data == 1)
                    {
                             debugger
                             @*toastr.success('Rateing applied');
                             setTimeout(function(){ location.reload();}, 2000);*@
                              localStorage.setItem('rate', 'true');
                              location.reload();
                    }
                    else if(data == 2)
                    {
                        toastr.error('First apply for the mission');
                    }
                    else if(data == 0)
                    {
                        toastr.info('Please wait for application approve');
                    }

                },

                error: function () {
                    alert("An error occurred while Sending Mission Rating!");
                }
            });

        }

        $(document).ready(function() {
    if (localStorage.getItem('rate') === 'true') {
         toastr.options = {
                                                        "closeButton": true
                                                    }
        toastr.success('Thanks for your rating');
       
        localStorage.setItem('rate', 'false');
    }
});

function searchMission(pg) {


    if (pg == undefined) {
        pg = 1;
    }
    debugger;
    $.ajax({
        url: "/Home/Volunteer",
        method: "POST",
        data: {
            "MissionId" : @ViewBag.missionDatas.MissionId,
            "pg": pg
        },
        success: function (data) {
            $('#volunteer').html(data);
        },
        error: function (request, error) {
            console.log(error);
        }
    })
    }

function AddComments(missionId)
       {
            var comment = $("#user-comment").val();

               if(comment == null || comment=="")
               {
                    $("#comment-status").html("please enter the comment");
                    $("#comment-status").css("color","red");
               }
               else
               {
                    debugger
                    $.ajax({

                        url:"/Home/AddComment",
                        method: "POST",

                        data:
                        {
                        comment:comment,
                        missionId:missionId
                        },
                        success:function(data)
                        {
                        $("#comment-status").html("comment sent for approvel");
                        $("#comment-status").css("color","green");
                        $('#user-comment').val('');
                        }
                    })
                }
        }

function ApplyMission(missionId)
            {
                debugger
                $.ajax({
                    url:"/Home/ApplyMission",
                    method:"Post",

                    data:{ missionId : missionId},

                    success: function(data)
                    {
                        if(data == 2)
                        {
                            toastr.success('Applied Mission');
                        }
                        else if(data == 1)
                        {
                            toastr.error('You alredy applied');
                        }
                        else if(data == 0)
                        {
                            toastr.info('Please wait your application in not approved');
                        }

                    },

                     error: function () {

                                }
                })
            }

function sendInvitation(MissionId)
            {
                debugger
                var CoWorkers = [];

                 $('input[name="CoWorkers"]:checked').each(function(){
                     CoWorkers.push(this.id);
                 });

                 if(CoWorkers.length != 0)
                 {
                     $.ajax({
                         url:"/Home/InviteWorker",
                         method: "POST",
                         data:{
                             "MissionId" : MissionId,
                             "CoWorkers" : CoWorkers
                         },
                         success:function(data){
                            $("#mission").html(data);
                            toastr.success('Mail sent successfully');   
                         },
                         error: function(request,error){

                             console.log(error);
                         }
                     })
                 }
                 else
                 {
                     toastr.error('First Select User');   
                     $('#exampleModal').modal('show');
                 }

            }

</script>   